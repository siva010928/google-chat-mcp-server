@startuml Google Chat MCP Server Workflow

!define RECTANGLE class
!define SEQUENCE_BLUE #E2F0FF
!define SEQUENCE_GREEN #E2FFE2
!define SEQUENCE_YELLOW #FFFFAA
!define TEXT_COLOR #333333

skinparam sequence {
  ArrowColor #5C6BC0
  ActorBorderColor #5C6BC0
  LifeLineBorderColor #5C6BC0
  LifeLineBackgroundColor #DEE6FF
  
  ParticipantBorderColor #5C6BC0
  ParticipantBackgroundColor #DEE6FF
  ParticipantFontColor #333333
  ParticipantFontSize 14
  
  ActorFontColor #333333
  ActorFontSize 14
}

skinparam note {
  BackgroundColor #FFF9C4
  BorderColor #FFD54F
  FontColor #333333
}

actor "User" as User
box "Cursor (MCP Client)" #SEQUENCE_BLUE
  participant "<b>Claude AI</b>" as Claude
  participant "<b>MCP Protocol</b>" as MCP
end box
box "MCP Server" #SEQUENCE_GREEN
  participant "<b>FastMCP Server</b>" as FastMCP
  participant "<b>Google Chat API</b>" as GoogleAPI
end box

title <font color=#5C6BC0><b>Google Chat MCP Workflow</b></font>

== <font color=#5C6BC0>Setup Phase</font> ==

User -> FastMCP: <font color=#333333>Initial setup with credentials.json</font>
note right #FFFFAA: One-time OAuth setup
FastMCP --> User: <font color=#333333>Authentication complete, token.json created</font>

== <font color=#5C6BC0>Message Operations</font> ==

User -> Claude: <font color=#333333>"Send a message to my team"</font>
activate Claude #DDDDFF
Claude -> MCP: <font color=#333333>Invoke Google Chat MCP tool</font>
activate MCP #DDDDFF
MCP -> FastMCP: <font color=#333333>HTTP request with parameters</font>
activate FastMCP #DDFFDD
FastMCP -> GoogleAPI: <font color=#333333>API request with auto-refreshed token</font>
activate GoogleAPI #DDFFDD
GoogleAPI --> FastMCP: <font color=#333333>Return response</font>
deactivate GoogleAPI
FastMCP --> MCP: <font color=#333333>Return result</font>
deactivate FastMCP
MCP --> Claude: <font color=#333333>Process response</font>
deactivate MCP
Claude --> User: <font color=#333333>"Message sent successfully"</font>
deactivate Claude

== <font color=#5C6BC0>Reading Messages</font> ==

User -> Claude: <font color=#333333>"Check my recent messages"</font>
activate Claude #DDDDFF
Claude -> FastMCP: <font color=#333333>Request messages via MCP</font>
activate FastMCP #DDFFDD
FastMCP -> GoogleAPI: <font color=#333333>Fetch messages with credentials</font>
activate GoogleAPI #DDFFDD
GoogleAPI --> FastMCP: <font color=#333333>Return message data</font>
deactivate GoogleAPI
FastMCP --> Claude: <font color=#333333>Process & analyze messages</font>
deactivate FastMCP
Claude --> User: <font color=#333333>Present message summary</font>
deactivate Claude

note right of FastMCP #FFF9C4
  <b>All requests automatically:</b>
  1. Use stored token.json
  2. Refresh tokens when needed
  3. Handle API authentication
end note

@enduml 